<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Number Plate Recognition</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    .preview { margin-top: 15px; }
    img { max-width: 300px; margin: 10px 0; border: 1px solid #ccc; }
  </style>
</head>
<body>
  <h2>Upload Image</h2>
  <form id="uploadForm">
    <input type="file" name="file" required>
    <button type="submit">Upload</button>
  </form>

  <div class="preview">
    <h3>Results:</h3>
    <p id="plate"></p>
    <div>
      <strong>Local Uploaded Image:</strong><br>
      <img id="localImg" src="" alt="Local Preview" hidden>
    </div>
    <div>
      <strong>Google Drive Image:</strong><br>
      <img id="driveImg" src="" alt="Drive Preview" hidden>
    </div>
    <p>
      <a id="sheetLink" href="#" target="_blank" hidden>View in Google Sheet</a>
    </p>
  </div>

  <script>
    document.getElementById("uploadForm").addEventListener("submit", async function(e) {
      e.preventDefault();

      const formData = new FormData(this);
      const res = await fetch("/upload", { method: "POST", body: formData });
      const data = await res.json();

      if (data.error) {
        alert("Error: " + data.error);
        return;
      }

      // Show plate number
      document.getElementById("plate").innerText = "Detected Plate: " + data.plateNumber;

      // Show local uploaded image
      const localImg = document.getElementById("localImg");
      localImg.src = data.localImage;
      localImg.hidden = false;

      // Show Drive uploaded image
      if (data.googleResult && data.googleResult.imageUrl) {
        const driveImg = document.getElementById("driveImg");
        driveImg.src = data.googleResult.imageUrl;
        driveImg.hidden = false;
      }

      // Show Google Sheet row link
      if (data.googleResult && data.googleResult.rowUrl) {
        const sheetLink = document.getElementById("sheetLink");
        sheetLink.href = data.googleResult.rowUrl;
        sheetLink.hidden = false;
      }
    });
  </script>
</body>
</html>
